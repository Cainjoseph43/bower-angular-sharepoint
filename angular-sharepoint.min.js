"use strict";angular.module("ExpertsInside.SharePoint",["ng"]).run(["$window","$log",function(a,b){angular.isUndefined(a.ShareCoffee)&&b.error("angular-sharepoint requires ShareCoffee to do its job. Please include ShareCoffe.js in your document")}]),angular.module("ExpertsInside.SharePoint").factory("$spConvert",function(){var a=function(a,c){if(!angular.isObject(c.__metadata)||c.__metadata.type!==a)throw b("badargs","expected argument to be of type {0}.",a)},b=angular.$$minErr("$spConvert"),c={spKeyValue:function(b){a("SP.KeyValue",b);var c=b.Value;switch(b.ValueType){case"Edm.Double":case"Edm.Float":return parseFloat(c);case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":return parseInt(c,10);case"Edm.Boolean":return"true"===c;default:return c}},spKeyValueArray:function(a){for(var b={},d=0,e=a.length;e>d;d+=1){var f=a[d],g=f.Key;b[g]=c.spKeyValue(f)}return b},spSimpleDataRow:function(b){a("SP.SimpleDataRow",b);var d=b.Cells.results||[];return c.spKeyValueArray(d)},spSimpleDataTable:function(b){a("SP.SimpleDataTable",b);for(var d=[],e=b.Rows.results||[],f=0,g=e.length;g>f;f+=1){var h=e[f];d.push(c.spSimpleDataRow(h))}return d},searchResult:function(b){a("Microsoft.Office.Server.Search.REST.SearchResult",b);var d=b.PrimaryQueryResult,e={elapsedTime:b.ElapsedTime,spellingSuggestion:b.SpellingSuggestion,properties:c.spKeyValueArray(b.Properties.results),primaryQueryResult:{queryId:d.QueryId,queryRuleId:d.QueryRuleId,relevantResults:c.spSimpleDataTable(d.RelevantResults.Table),customResults:null!==d.CustomResults?c.spSimpleDataTable(d.CustomResults.Table):null,refinementResults:null!==d.RefinementResults?c.spSimpleDataTable(d.RefinementResults.Table):null,specialTermResults:null!==d.SpecialTermResults?c.spSimpleDataTable(d.SpecialTermResults.Table):null}};return e},suggestResult:function(a){return a},userResult:function(b){a("SP.UserProfiles.PersonProperties",b);var d={accountName:b.AccountName,displayName:b.DisplayName,email:b.Email,isFollowed:b.IsFollowed,personalUrl:b.PersonalUrl,pictureUrl:b.PictureUrl,profileProperties:c.spKeyValueArray(b.UserProfileProperties),title:b.Title,userUrl:b.UserUrl};return d},capitalize:function(a){return angular.isUndefined(a)||null===a?null:a.charAt(0).toUpperCase()+a.slice(1)}};return c}),angular.module("ExpertsInside.SharePoint").factory("$spList",["$spRest","$http","$spConvert",function($spRest,$http,$spConvert){function listFactory(title,listOptions){if(!angular.isString(title)||""===title)throw $spListMinErr("badargs","title must be a nen-empty string.");angular.isObject(listOptions)||(listOptions={});var normalizedTitle=$spConvert.capitalize(title.replace(/[^A-Za-z0-9 ]/g,"").replace(/\s/g,"_x0020_")),className=$spConvert.capitalize(normalizedTitle.replace(/_x0020/g,"").replace(/^\d+/,"")),listItemType="SP.Data."+normalizedTitle+"ListItem",List=function(){var script=" (function() {                        function {{List}}(data) {            this.__metadata = {                  type: '"+listItemType+"'     };                                 angular.extend(this, data);      }                                  return {{List}};                 })();                             ";return eval(script.replace(/{{List}}/g,className))}();return List.$title=title,List.$$relativeUrl="web/lists/getByTitle('"+title+"')",List.$$inHostWeb=!!listOptions.inHostWeb,List.$$decorateResult=function(a,b){return angular.isArray(a)||a instanceof List||(a=new List(a)),angular.isUndefined(a.$resolved)&&(a.$resolved=!1),a.$promise=$http(b).then(function(b){var c=b.data;if(angular.isArray(a)&&angular.isArray(c))angular.forEach(c,function(b){a.push(new List(b))});else{if(!angular.isObject(a))throw $spListMinErr("badresponse","Expected response to contain an {0} but got an {1}",angular.isArray(a)?"array":"object",angular.isArray(c)?"array":"object");if(angular.isArray(c)){if(1!==c.length)throw $spListMinErr("badresponse","Expected response to contain an array with one object but got {1}",c.length);angular.extend(a,c[0])}else angular.isObject(c)&&angular.extend(a,c)}var d;return 204===b.status&&angular.isString(d=b.headers("ETag"))&&(a.__metadata.etag=d),a.$resolved=!0,a}),a},List.get=function(a,b){if(angular.isUndefined(a)||null===a)throw $spListMinErr("badargs","id is required.");var c={Id:a},d=$spRest.buildHttpConfig(List,"get",{id:a,query:b});return List.$$decorateResult(c,d)},List.query=function(a,b){var c=angular.isDefined(b)&&b.singleResult?{}:[],d=$spRest.buildHttpConfig(List,"query",{query:angular.extend({},List.prototype.$$queryDefaults,a)});return List.$$decorateResult(c,d)},List.create=function(a,b){if(!(angular.isObject(a)&&a instanceof List))throw $spListMinErr("badargs","item must be a List instance.");a.__metadata=angular.extend({type:listItemType},a.__metadata);var c=$spRest.buildHttpConfig(List,"create",{item:a,query:angular.extend({},a.$$queryDefaults,b)});return List.$$decorateResult(a,c)},List.update=function(a,b){if(!(angular.isObject(a)&&a instanceof List))throw $spListMinErr("badargs","item must be a List instance.");b=angular.extend({},b,{item:a});var c=$spRest.buildHttpConfig(List,"update",b);return List.$$decorateResult(a,c)},List.save=function(a,b){if(angular.isDefined(a.__metadata)&&angular.isDefined(a.__metadata.id))return this.update(a,b);var c=angular.isObject(b)?b.query:void 0;return this.create(a,c)},List.delete=function(a){if(!(angular.isObject(a)&&a instanceof List))throw $spListMinErr("badargs","item must be a List instance.");var b=$spRest.buildHttpConfig(List,"delete",{item:a});return List.$$decorateResult(a,b)},List.queries={},List.addNamedQuery=function(a,b,c){return List.queries[a]=function(){var a=angular.extend({},List.prototype.$$queryDefaults,b.apply(List,arguments));return List.query(a,c)},List},List.prototype={$$readOnlyFields:angular.extend(["AttachmentFiles","Attachments","Author","AuthorId","ContentType","ContentTypeId","Created","Editor","EditorId","FieldValuesAsHtml","FieldValuesAsText","FieldValuesForEdit","File","FileSystemObjectType","FirstUniqueAncestorSecurableObject","Folder","GUID","Modified","OData__UIVersionString","ParentList","RoleAssignments"],listOptions.readOnlyFields),$$queryDefaults:angular.extend({},listOptions.query),$save:function(a){return List.save(this,a).$promise},$delete:function(){return List.delete(this).$promise},$isNew:function(){return angular.isUndefined(this.__metadata)||angular.isUndefined(this.__metadata.id)}},List}var $spListMinErr=angular.$$minErr("$spList");return listFactory}]),angular.module("ExpertsInside.SharePoint").factory("$spPageContextInfo",["$rootScope","$window",function(a,b){var c={};return angular.copy(b._spPageContextInfo,c),a.$watch(function(){return b._spPageContextInfo},function(a){angular.copy(a,c)},!0),c}]),angular.module("ExpertsInside.SharePoint").factory("$spRest",["$log",function(a){function b(a){var b=[];if(angular.isUndefined(a)||null===a)return b;for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b.sort()}var c=angular.$$minErr("$spRest"),d=function(a){return a.reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[])},e=["$select","$filter","$orderby","$top","$skip","$expand","$sort"],f={transformResponse:function(a){var b={};return angular.isDefined(a)&&null!==a&&""!==a&&(b=angular.fromJson(a)),angular.isObject(b)&&angular.isDefined(b.d)&&(b=b.d),angular.isObject(b)&&angular.isDefined(b.results)&&(b=b.results),b},buildQueryString:function(a){var c=[],e=b(a);angular.forEach(e,function(b){var e=a[b];null===e||angular.isUndefined(e)||(angular.isArray(e)&&(e=d(e).join(",")),angular.isObject(e)&&(e=angular.toJson(e)),c.push(b+"="+e))});var f=c.join("&");return f},normalizeParams:function(b){return b=angular.extend({},b),angular.isDefined(b)&&angular.forEach(b,function(c,d){0!==d.indexOf("$")&&(delete b[d],d="$"+d,b[d]=c),-1===e.indexOf(d)&&(a.warn("Invalid param key: "+d),delete b[d])}),(null===b||"{}"===JSON.stringify(b))&&(b=void 0),b},appendQueryString:function(a,b){var c=f.buildQueryString(b);return""!==c&&(a+=(-1===a.indexOf("?")?"?":"&")+c),a},createPayload:function(a){var b=angular.extend({},a);return angular.isDefined(a.$$readOnlyFields)&&angular.forEach(a.$$readOnlyFields,function(a){delete b[a]}),angular.toJson(b)},buildHttpConfig:function(a,b,d){var e=a.$$relativeUrl+"/items",g={url:e};a.$$inHostWeb&&(g.hostWebUrl=ShareCoffee.Commons.getHostWebUrl()),b=angular.isString(b)?b.toLowerCase():"",d=angular.isDefined(d)?d:{};var h=angular.isDefined(d.query)?f.normalizeParams(d.query):{};switch(b){case"get":if(angular.isUndefined(d.id))throw c("options:get","options must have an id");g.url+="("+d.id+")",g=ShareCoffee.REST.build.read.for.angularJS(g);break;case"query":g=ShareCoffee.REST.build.read.for.angularJS(g);break;case"create":if(angular.isUndefined(d.item))throw c("options:create","options must have an item");angular.isDefined(h)&&delete h.$expand,g.payload=f.createPayload(d.item),g=ShareCoffee.REST.build.create.for.angularJS(g);break;case"update":if(angular.isUndefined(d.item))throw c("options:update","options must have an item");if(angular.isUndefined(d.item.__metadata))throw c("options:update","options.item must have __metadata");h={},g.url+="("+d.item.Id+")",g.payload=f.createPayload(d.item),g.eTag=!d.force&&angular.isDefined(d.item.__metadata)?d.item.__metadata.etag:null,g=ShareCoffee.REST.build.update.for.angularJS(g);break;case"delete":if(angular.isUndefined(d.item))throw c("options:delete","options must have an item");if(angular.isUndefined(d.item.__metadata))throw c("options:delete","options.item must have __metadata");g.url+="("+d.item.Id+")",g=ShareCoffee.REST.build.delete.for.angularJS(g)}return g.url=f.appendQueryString(g.url,h),g.transformResponse=f.transformResponse,g}};return f}]),angular.module("ExpertsInside.SharePoint").factory("$spSearch",["$http","$spRest","$spConvert",function(a,b,c){var d=angular.$$minErr("$spSearch"),e={$createQueryProperties:function(a,b){var c;switch(a){case"postquery":c=new ShareCoffee.PostQueryProperties;break;case"suggest":c=new ShareCoffee.SuggestProperties;break;default:c=new ShareCoffee.QueryProperties}return angular.extend(c,b)},$decorateResult:function(b,e){return angular.isUndefined(b.$resolved)&&(b.$resolved=!1),b.$raw=null,b.$promise=a(e).then(function(a){var e=a.data;if(angular.isObject(e)&&(angular.isDefined(e.query)?(b.$raw=e.query,angular.extend(b,c.searchResult(e.query))):angular.isDefined(e.suggest)&&(b.$raw=e.suggest,angular.extend(b,c.suggestResult(e.suggest)))),angular.isUndefined(b.$raw))throw d("badresponse","Response does not contain a valid search result.");return b.$resolved=!0,b}),b},query:function(a){a=angular.extend({},a);var c=a.searchType;delete a.searchType;var d=e.$createQueryProperties(c,a),f=ShareCoffee.REST.build.read.for.angularJS(d);f.transformResponse=b.transformResponse;var g={};return e.$decorateResult(g,f)},postquery:function(a){return a=angular.extend(a,{searchType:"postquery"}),e.query(a)},suggest:function(a){return a=angular.extend(a,{searchType:"suggest"}),e.query(a)}};return e}]),angular.module("ExpertsInside.SharePoint").factory("$spUser",["$http","$spRest","$spConvert",function(a,b,c){var d=angular.$$minErr("$spUser"),e={$decorateResult:function(b,e){return angular.isUndefined(b.$resolved)&&(b.$resolved=!1),b.$raw=null,b.$promise=a(e).then(function(a){var e=a.data;if(!angular.isDefined(e))throw d("badresponse","Response does not contain a valid user result.");return b.$raw=e,angular.extend(b,c.userResult(e)),b.$resolved=!0,b}),b},current:function(){var a=new ShareCoffee.UserProfileProperties(ShareCoffee.Url.GetMyProperties),c=ShareCoffee.REST.build.read.for.angularJS(a);c.transformResponse=b.transformResponse;var d={};return e.$decorateResult(d,c)},get:function(a){var c=new ShareCoffee.UserProfileProperties(ShareCoffee.Url.GetProperties,a),d=ShareCoffee.REST.build.read.for.angularJS(c);d.transformResponse=b.transformResponse;var f={};return e.$decorateResult(f,d)}};return e}]);
//# sourceMappingURL=angular-sharepoint.min.map