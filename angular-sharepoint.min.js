angular.module("ExpertsInside.SharePoint",["ng"]),angular.module("ExpertsInside.SharePoint").factory("$spList",["$spPageContextInfo","$spRequestDigest","$http","$log",function(a,b,c,d){"use strict";function e(a,b){if(!a)throw g("badargs","name cannot be blank.");this.name=a.toString();var c=this.name.charAt(0).toUpperCase()+this.name.slice(1);this.defaults=angular.extend({itemType:"SP.Data."+c+"ListItem"},b)}function f(a,b){return new e(a,b)}var g=angular.$$minErr("$spList"),h=["$select","$filter","$orderby","$top","$skip","$expand","$sort"];return e.prototype={$baseUrl:function(){return a.webServerRelativeUrl+"/_api/web/lists/getByTitle('"+this.name+"')"},$buildHttpConfig:function(a,c,d){var e=this.$baseUrl(),f={url:e,params:c,headers:{accept:"application/json;odata=verbose"},transformResponse:function(a){var b=JSON.parse(a);return angular.isDefined(b.d)&&(b=b.d),angular.isDefined(b.results)&&(b=b.results),b}};switch(a){case"get":f.url=e+"/items("+d+")",f.method="GET";break;case"query":f.url=e+"/items",f.method="GET";break;case"create":f.url=e+"/items",f.method="POST",angular.extend(f.headers,{"X-RequestDigest":b(),"content-type":"application/json;odata=verbose"});break;case"save":f.url=d.__metdata.uri,f.method="POST",angular.extend(f.headers,{"X-HTTP-Method":"MERGE","X-RequestDigest":b(),"IF-MATCH":d.__metadata.etag||"*","content-type":"application/json;odata=verbose"})}return f},$normalizeParams:function(a){return a=angular.extend({},a),angular.isDefined(a)&&angular.forEach(a,function(b,c){0!==c.indexOf("$")&&(delete a[c],c="$"+c,a[c]=b),angular.isArray(b)&&(a[c]=b.join(",")),-1===h.indexOf(c)&&(d.warn("Invalid param key: "+c),delete a[c])}),(null===a||"{}"===JSON.stringify(a))&&(a=void 0),a},$createResult:function(a,b){var d=a;return d.$promise=c(b).success(function(a){return angular.extend(d,a),d}),d},get:function(a,b){if(angular.isUndefined(a))throw g("badargs","id is required.");b=this.$normalizeParams(b);var c=this.$buildHttpConfig("get",b,a);return this.$createResult({Id:a},c)},query:function(a){a=this.$normalizeParams(a);var b=this.$buildHttpConfig("query",a);return this.$createResult([],b)},create:function(a){var b=this.defaults.itemType;if(!b)throw g("badargs","Cannot create an item without a valid type.Please set the default item type on the list (list.defaults.itemType).");var c={__metadata:{type:b}},d=angular.extend({},c,a),e=this.$buildHttpConfig("create",void 0,d);return this.$createResult(d,e)},save:function(a){if(angular.isUndefined(a.__metadata))throw"o";var b=this.$buildHttpConfig("save",void 0,a);return this.$createResult([],b)}},f.List=e,f}]),angular.module("ExpertsInside.SharePoint").factory("$spPageContextInfo",["$rootScope","$window",function(a,b){"use strict";var c={};return angular.copy(b._spPageContextInfo,c),a.$watch(function(){return b._spPageContextInfo},function(a){angular.copy(a,c)},!0),c}]),angular.module("ExpertsInside.SharePoint").factory("$spRequestDigest",["$window",function(a){"use strict";var b=angular.$$minErr("$spRequestDigest");return function(){var c=a.document.getElementById("__REQUESTDIGEST");if(angular.isUndefined(c))throw b("notfound","Cannot read request digest from DOM.");return c.value}}]);
//# sourceMappingURL=angular-sharepoint.min.map